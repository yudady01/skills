---
name: invoice-organizer
description: 透過讀取混亂的檔案、提取關鍵資訊、一致地重新命名並將它們分類到邏輯資料夾中，自動整理發票和收據以進行報稅準備。將數小時的手動記帳工作變成幾分鐘的自動化整理。
---

# 發票整理器

這個 skill 將混亂的發票、收據和財務文件資料夾轉變為乾淨、報稅就緒的歸檔系統，無需手動操作。

## 何時使用此 Skill

- 準備報稅季並需要整理好的記錄
- 管理跨多個供應商的業務費用
- 整理來自混亂資料夾或電子郵件下載的收據
- 為持續記帳設定自動發票歸檔
- 按年份或類別歸檔財務記錄
- 核對報銷費用
- 為會計師準備文件

## 此 Skill 的功能

1. **讀取發票內容**：從 PDF、圖片和文件中提取資訊：
   - 供應商/公司名稱
   - 發票編號
   - 日期
   - 金額
   - 產品或服務描述
   - 付款方式

2. **一致地重新命名檔案**：建立標準化的檔案名稱：
   - 格式：`YYYY-MM-DD 供應商 - Invoice - 產品或服務.pdf`
   - 範例：`2024-03-15 Adobe - Invoice - Creative Cloud.pdf`

3. **按類別整理**：分類到邏輯資料夾：
   - 按供應商
   - 按費用類別（軟體、辦公室、差旅等）
   - 按時間週期（年、季、月）
   - 按稅務類別（可扣除、個人等）

4. **處理多種格式**：適用於：
   - PDF 發票
   - 掃描收據（JPG、PNG）
   - 電子郵件附件
   - 螢幕截圖
   - 銀行對帳單

5. **維護原始檔案**：在整理副本時保留原始檔案

## 使用方法

### 基本用法

導航到您混亂的發票資料夾：
```
cd ~/Desktop/receipts-to-sort
```

然後詢問 Claude Code：
```
為報稅整理這些發票
```

或更具體地說：
```
讀取此資料夾中的所有發票，將它們重新命名為
「YYYY-MM-DD 供應商 - Invoice - 產品.pdf」格式，
並按供應商整理它們
```

### 進階整理

```
整理這些發票：
1. 從每個檔案提取日期、供應商和描述
2. 重新命名為標準格式
3. 按費用類別（軟體、辦公室、差旅等）分類到資料夾
4. 為我的會計師建立包含所有發票詳細資訊的 CSV 試算表
```

## 指示說明

當使用者請求整理發票時：

1. **掃描資料夾**

   識別所有發票檔案：
   ```bash
   # 尋找所有發票相關檔案
   find . -type f \( -name "*.pdf" -o -name "*.jpg" -o -name "*.png" \) -print
   ```

   報告發現：
   - 檔案總數
   - 檔案類型
   - 日期範圍（如果可從名稱辨識）
   - 目前組織方式（或缺乏組織）

2. **從每個檔案提取資訊**

   對於每張發票，提取：

   **從 PDF 發票**：
   - 使用文字提取讀取發票內容
   - 尋找常見模式：
     - 「發票日期：」、「日期：」、「開立日期：」
     - 「發票編號：」、「發票號碼：」
     - 公司名稱（通常在頂部）
     - 「應付金額：」、「總計：」、「金額：」
     - 「描述：」、「服務：」、「產品：」

   **從圖片收據**：
   - 從圖片讀取可見文字
   - 識別供應商名稱（通常在頂部）
   - 尋找日期（常見格式）
   - 找到總金額

   **不清楚檔案的備選方案**：
   - 使用檔案名稱線索
   - 檢查檔案建立/修改日期
   - 如果缺少關鍵資訊，標記為需要手動審查

3. **確定整理策略**

   如果未指定，詢問使用者偏好：

   ```markdown
   我找到了來自 [日期範圍] 的 [X] 張發票。

   您希望如何整理它們？

   1. **按供應商**（Adobe/、Amazon/、Stripe/ 等）
   2. **按類別**（軟體/、辦公用品/、差旅/ 等）
   3. **按日期**（2024/Q1/、2024/Q2/ 等）
   4. **按稅務類別**（可扣除/、個人/ 等）
   5. **自訂**（描述您的結構）

   或者我可以使用預設結構：年份/類別/供應商
   ```

4. **建立標準化檔案名稱**

   對於每張發票，建立遵循此模式的檔案名稱：

   ```
   YYYY-MM-DD 供應商 - Invoice - 描述.ext
   ```

   範例：
   - `2024-03-15 Adobe - Invoice - Creative Cloud.pdf`
   - `2024-01-10 Amazon - Receipt - Office Supplies.pdf`
   - `2023-12-01 Stripe - Invoice - Monthly Payment Processing.pdf`

   **檔案名稱最佳實踐**：
   - 移除特殊字元，除了連字號
   - 正確大寫供應商名稱
   - 保持描述簡潔但有意義
   - 使用一致的日期格式（YYYY-MM-DD）以便排序
   - 保留原始檔案副檔名

5. **執行整理**

   在移動檔案之前，顯示計劃：

   ```markdown
   # 整理計劃

   ## 建議的結構
   ```
   Invoices/
   ├── 2023/
   │   ├── Software/
   │   │   ├── Adobe/
   │   │   └── Microsoft/
   │   ├── Services/
   │   └── Office/
   └── 2024/
       ├── Software/
       ├── Services/
       └── Office/
   ```

   ## 範例變更

   之前：`invoice_adobe_march.pdf`
   之後：`2024-03-15 Adobe - Invoice - Creative Cloud.pdf`
   位置：`Invoices/2024/Software/Adobe/`

   之前：`IMG_2847.jpg`
   之後：`2024-02-10 Staples - Receipt - Office Supplies.jpg`
   位置：`Invoices/2024/Office/Staples/`

   處理 [X] 個檔案？（是/否）
   ```

   批准後：
   ```bash
   # 建立資料夾結構
   mkdir -p "Invoices/2024/Software/Adobe"

   # 複製（不移動）以保留原始檔案
   cp "original.pdf" "Invoices/2024/Software/Adobe/2024-03-15 Adobe - Invoice - Creative Cloud.pdf"

   # 或如果使用者偏好則移動
   mv "original.pdf" "new/path/standardized-name.pdf"
   ```

6. **生成摘要報告**

   建立包含所有發票詳細資訊的 CSV 檔案：

   ```csv
   日期,供應商,發票編號,描述,金額,類別,檔案路徑
   2024-03-15,Adobe,INV-12345,Creative Cloud,52.99,軟體,Invoices/2024/Software/Adobe/2024-03-15 Adobe - Invoice - Creative Cloud.pdf
   2024-03-10,Amazon,123-4567890-1234567,辦公用品,127.45,辦公室,Invoices/2024/Office/Amazon/2024-03-10 Amazon - Receipt - Office Supplies.pdf
   ...
   ```

   此 CSV 用於：
   - 匯入會計軟體
   - 與會計師分享
   - 費用追蹤和報告
   - 報稅準備

7. **提供完成摘要**

   ```markdown
   # 整理完成！📊

   ## 摘要
   - **已處理**：[X] 張發票
   - **日期範圍**：[最早] 到 [最晚]
   - **總金額**：$[總和]（如果提取了金額）
   - **供應商**：[Y] 個獨特供應商

   ## 新結構
   ```
   Invoices/
   ├── 2024/（45 個檔案）
   │   ├── Software/（23 個檔案）
   │   ├── Services/（12 個檔案）
   │   └── Office/（10 個檔案）
   └── 2023/（12 個檔案）
   ```

   ## 建立的檔案
   - `/Invoices/` - 整理好的發票
   - `/Invoices/invoice-summary.csv` - 會計試算表
   - `/Invoices/originals/` - 原始檔案（如果複製）

   ## 需要審查的檔案
   [列出任何無法完全提取資訊的檔案]

   ## 後續步驟
   1. 審查 `invoice-summary.csv` 檔案
   2. 檢查「需要審查」資料夾中的檔案
   3. 將 CSV 匯入您的會計軟體
   4. 為未來發票設定自動整理

   報稅季準備就緒！🎉
   ```

## 範例

### 範例 1：報稅準備（來自 Martin Merschroth）

**使用者**：「我有一個混亂的發票資料夾用於報稅。將它們分類並正確重新命名。」

**流程**：
1. 掃描資料夾：找到 147 個 PDF 和圖片
2. 讀取每張發票以提取：
   - 日期
   - 供應商名稱
   - 發票編號
   - 產品/服務描述
3. 重新命名所有檔案：`YYYY-MM-DD 供應商 - Invoice - 產品.pdf`
4. 整理到：`2024/Software/`、`2024/Travel/` 等
5. 為會計師建立 `invoice-summary.csv`
6. 結果：幾分鐘內報稅就緒的整理發票

### 範例 2：每月費用核對

**使用者**：「按類別整理我上個月的業務收據。」

**輸出**：
```markdown
# 2024 年 3 月收據已整理

## 按類別
- 軟體與工具：$847.32（12 張發票）
- 辦公用品：$234.18（8 張收據）
- 差旅與餐飲：$1,456.90（15 張收據）
- 專業服務：$2,500.00（3 張發票）

總計：$5,038.40

所有收據已重新命名並歸檔於：
`Business-Receipts/2024/03-March/[類別]/`

CSV 匯出：`march-2024-expenses.csv`
```

### 範例 3：多年歸檔

**使用者**：「我有 3 年的隨機發票。先按年份整理，然後按供應商。」

**輸出**：建立結構：
```
Invoices/
├── 2022/
│   ├── Adobe/
│   ├── Amazon/
│   └── ...
├── 2023/
│   ├── Adobe/
│   ├── Amazon/
│   └── ...
└── 2024/
    ├── Adobe/
    ├── Amazon/
    └── ...
```

每個檔案都以日期和描述正確重新命名。

### 範例 4：電子郵件下載清理

**使用者**：「我從 Gmail 下載發票。它們都命名為『invoice.pdf』、『invoice(1).pdf』等。修復這個混亂。」

**輸出**：
```markdown
找到 89 個檔案都命名為「invoice*.pdf」

讀取每個檔案以提取真實資訊...

重新命名範例：
- invoice.pdf → 2024-03-15 Shopify - Invoice - Monthly Subscription.pdf
- invoice(1).pdf → 2024-03-14 Google - Invoice - Workspace.pdf
- invoice(2).pdf → 2024-03-10 Netlify - Invoice - Pro Plan.pdf

所有檔案已重新命名並按供應商整理。
```

## 常見整理模式

### 按供應商（簡單）
```
Invoices/
├── Adobe/
├── Amazon/
├── Google/
└── Microsoft/
```

### 按年份和類別（報稅友善）
```
Invoices/
├── 2023/
│   ├── Software/
│   ├── Hardware/
│   ├── Services/
│   └── Travel/
└── 2024/
    └── ...
```

### 按季度（詳細追蹤）
```
Invoices/
├── 2024/
│   ├── Q1/
│   │   ├── Software/
│   │   ├── Office/
│   │   └── Travel/
│   └── Q2/
│       └── ...
```

### 按稅務類別（會計師就緒）
```
Invoices/
├── Deductible/
│   ├── Software/
│   ├── Office/
│   └── Professional-Services/
├── Partially-Deductible/
│   └── Meals-Travel/
└── Personal/
```

## 自動化設定

對於持續整理：

```
建立一個腳本監控我的 ~/Downloads/invoices 資料夾
並使用我們的標準命名和資料夾結構自動整理任何新的發票檔案。
```

這建立了一個持久的解決方案，在發票到達時進行整理。

## 專業技巧

1. **將電子郵件掃描為 PDF**：先使用 Preview 或類似工具將電子郵件發票儲存為 PDF
2. **一致的下載**：將所有發票儲存到一個資料夾以進行批次處理
3. **每月例行作業**：每月整理發票，而非每年
4. **備份原始檔案**：在重新整理前保留原始檔案
5. **在 CSV 中包含金額**：對預算追蹤有用
6. **按可扣除性標記**：註明哪些費用可抵稅
7. **保留收據 7 年**：標準稽核期間

## 處理特殊情況

### 缺少資訊
如果無法提取日期/供應商：
- 標記檔案供手動審查
- 使用檔案修改日期作為備選
- 建立「Needs-Review/」資料夾

### 重複發票
如果相同發票出現多次：
- 比較檔案雜湊值
- 保留最高品質版本
- 在摘要中註明重複項

### 多頁發票
對於分散在多個檔案的發票：
- 如需要則合併 PDF
- 為部分使用一致的命名
- 如果發票分散，在 CSV 中註明

### 非標準格式
對於不尋常的收據格式：
- 盡可能提取
- 盡可能標準化
- 如果缺少關鍵資訊，標記供審查

## 相關使用案例

- 為報銷建立費用報告
- 整理銀行對帳單
- 管理供應商合約
- 歸檔舊財務記錄
- 為稽核做準備
- 追蹤訂閱成本隨時間變化
