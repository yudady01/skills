---
description: 执行智能代码审查，检查代码质量、合规性和最佳实践，支持AI驱动的架构分析和问题诊断
allowed-tools: [Read, Write, Edit, Glob, Grep, Bash, TodoWrite, Task]
---

# 智能代码审查命令

这个命令执行全面的智能代码审查，确保代码符合质量标准和最佳实践。支持AI驱动的架构建议和问题诊断能力。

## 命令选项

### 基础审查选项
- **无选项**: 执行标准代码审查流程
- `--intelligent`: 启用智能分析模式，集成AI驱动的代码审查
- `--architecture-analysis`: 执行深度架构分析，提供微服务设计建议
- `--auto-diagnose`: 启用自动问题诊断，识别潜在问题并提供修复建议
- `--full`: 执行完整的智能审查（包含所有智能分析功能）

### 智能分析配置
- `--focus <area>`: 重点关注特定领域（architecture, performance, security, maintainability）
- `--severity <level>`: 设置问题报告的最小严重级别（low, medium, high, critical）
- `--suggestions <count>`: 限制建议数量，专注于最重要的改进（默认：10）

## 审查维度

### 1. 代码质量（传统+智能）
- 类型安全检查
- 代码复杂度分析
- 性能影响评估
- 错误处理检查
- **智能增强**: 代码异味自动识别
- **智能增强**: 潜在bug预测分析

### 2. 合规性检查
- 编码标准符合性
- 项目规范遵循
- 安全最佳实践
- 文档完整性
- **智能增强**: 企业级Spring Boot 2.7合规性
- **智能增强**: Dubbo 3微服务规范验证

### 3. 最佳实践
- 设计模式应用
- 可维护性评估
- 可扩展性考虑
- 测试覆盖率检查
- **智能增强**: 微服务架构最佳实践
- **智能增强**: 分布式系统设计模式检查

### 4. 智能架构分析 [新增]
- 微服务边界合理性分析
- Dubbo服务设计模式检查
- 数据一致性策略评估
- 缓存架构合理性审查
- 消息队列使用模式分析

### 5. 智能问题诊断 [新增]
- 性能瓶颈智能识别
- 安全漏洞自动扫描
- 资源泄漏风险检测
- 并发问题分析
- 分布式事务问题诊断

## 审查流程

### 标准审查流程
1. **静态分析** - 运行自动化检查工具
2. **代码审查** - 人工审查代码逻辑和结构
3. **测试验证** - 验证测试覆盖和质量
4. **文档检查** - 确保文档完整和准确
5. **建议生成** - 提供改进建议和修复方案

### 智能审查流程 [增强]
1. **静态分析** - 运行自动化检查工具
2. **智能预分析** - AI驱动的代码模式识别和问题预测
3. **架构分析** - 深度微服务架构评估（可选）
4. **问题诊断** - 自动问题识别和根因分析（可选）
5. **代码审查** - 结合AI建议的人工审查
6. **智能建议生成** - AI生成的改进建议和修复方案
7. **优先级排序** - 基于影响度和紧急程度对建议排序
8. **修复指导** - 提供具体的代码修改指导

## 智能代理集成

### code-reviewer代理 [增强]
- 集成智能架构分析模块
- 基于Spring Boot 2.7 + Dubbo 3的专业知识
- 支持上下文感知的建议生成

### architecture-analyzer代理 [新增]
- 专注于微服务架构分析
- 评估服务边界合理性
- 分析分布式系统设计模式

### intelligent-diagnoser代理 [新增]
- 智能问题诊断和根因分析
- 自动修复建议生成
- 性能瓶颈和安全漏洞识别

## 输出格式

### 标准审查报告
- 代码质量评分
- 发现的问题列表
- 改进建议
- 测试覆盖率报告

### 智能审查报告 [增强]
- **整体健康度评分**: 综合代码质量、架构合理性、性能安全等多维度评分
- **问题分类统计**: 按严重程度和类型分类的问题统计
- **智能建议列表**: AI生成的具体改进建议，包含：
  - 问题描述和影响分析
  - 具体的代码修改示例
  - 最佳实践对比说明
- **架构优化建议**: 针对Spring Boot + Dubbo微服务的架构改进方案
- **性能优化建议**: 基于代码分析的性能提升建议
- **安全加固建议**: 安全漏洞修复和最佳实践建议

## 使用示例

```bash
# 标准代码审查
/review

# 智能代码审查
/review --intelligent

# 深度架构分析
/review --architecture-analysis --focus architecture

# 自动问题诊断
/review --auto-diagnose --severity medium

# 完整智能审查
/review --full --suggestions 15
```

## 配置和个性化

### 审查配置文件
支持项目级配置文件 `.ai-coding-review.json`:
```json
{
  "intelligent_analysis": true,
  "architecture_focus": ["microservices", "dubbo", "performance"],
  "severity_threshold": "medium",
  "custom_rules": {
    "company_standards": true,
    "project_specific_checks": true
  }
}
```